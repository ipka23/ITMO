<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      lang="ru" id="html">

<h:head>
    <meta charset="UTF-8" />
    <title>
        Веб лаба 3
    </title>
    <h:outputStylesheet name="css/main.css" />
    <h:outputScript name="js/script.js"/>
</h:head>

<h:body>
    <header class="header">
        <span>
            Пчелкин Илья Игоревич, P3206, Вариант 999312
        </span>
    </header>

    <h:form id="mainForm">
        <h:button styleClass="main-btn" value="Стартовая страница" outcome="index" />

<!--        autoRun="true"-->

        <table class="main">
            <tr>
                <td class="mainCell">
                    <span id="svgError"></span>
                    <br/>
<!--                <h:panelGroup id="svgContainer" >-->
                    <p:remoteCommand
                            name="remotePointCommand"
                            update="statsTable"
                            action="#{pointsBean.addPointFromSvg(param.x, param.y, param.r)}"
                            immediate="true">

<!--                        process="@this"-->

                        <f:param name="x"/>
                        <f:param name="y"/>
                        <f:param name="r"/>
                    </p:remoteCommand>


                    <svg id="mainSvg" width="300" height="300" viewBox="0 0 300 300">

                        <rect x="100" y="50" width="50" height="100"
                              fill="#00BFFF" stroke="#00BFFF" stroke-width="1"/>

                        <polygon points="150,50 200,150 150,150"
                                 fill="#00BFFF" stroke="#00BFFF" stroke-width="1"/>

                        <path d="M 150 150 L 150 200 A 50 50 0 0 1 100 150 Z"
                              fill="#00BFFF" stroke="#00BFFF" stroke-width="1"/>

                        <!-- lines -->
                        <line x1="0" y1="150" x2="300" y2="150" stroke="black" stroke-width="1"/>
                        <line x1="150" y1="0" x2="150" y2="300" stroke="black" stroke-width="1"/>
                        <line x1="150" y1="0" x2="160" y2="10" stroke="black" stroke-width="1"/>
                        <line x1="140" y1="10" x2="150" y2="0" stroke="black" stroke-width="1"/>
                        <line x1="300" y1="150" x2="290" y2="160" stroke="black" stroke-width="1"/>
                        <line x1="290" y1="140" x2="300" y2="150" stroke="black" stroke-width="1"/>

                        <!-- Ox R -->
                        <text x="50" y="145" fill="black" id="-rx">-R</text>
                        <text x="100" y="145" fill="black" id="-rx/2">-R/2</text>
                        <text x="200" y="145" fill="black" id="rx/2">R/2</text>
                        <text x="250" y="145" fill="black" id="rx">R</text>

                        <!-- Oy R -->
                        <text x="155" y="50" fill="black" id="ry">R</text>
                        <text x="155" y="100" fill="black" id="ry/2">R/2</text>
                        <text x="160" y="200" fill="black" id="-ry/2">-R/2</text>
                        <text x="160" y="250" fill="black" id="-ry">-R</text>

                        <!-- axes names -->
                        <text x="290" y="140" fill="black">x</text>
                        <text x="160" y="10" fill="black">y</text>

                        <!-- marks on lines -->
                        <!-- Ox -->
                        <line x1="50" y1="145" x2="50" y2="155" fill="black" stroke="black"/>
                        <line x1="100" y1="145" x2="100" y2="155" fill="black" stroke="black"/>
                        <line x1="200" y1="145" x2="200" y2="155" fill="black" stroke="black"/>
                        <line x1="250" y1="145" x2="250" y2="155" fill="black" stroke="black"/>
                        <!-- Oy -->
                        <line x1="145" y1="50" x2="155" y2="50" fill="black" stroke="black"/>
                        <line x1="145" y1="100" x2="155" y2="100" fill="black" stroke="black"/>
                        <line x1="145" y1="200" x2="155" y2="200" fill="black" stroke="black"/>
                        <line x1="145" y1="250" x2="155" y2="250" fill="black" stroke="black"/>
                        <ui:repeat value="#{pointsBean.points}" var="point">
                            <circle r="1%"
                                    cx="#{pointsBean.getSvgX(point)}"
                                    cy="#{pointsBean.getSvgY(point)}"
                                    fill="black"/>
                        </ui:repeat>
                    </svg>
                </td>
                <td>
                    <div class="coordinates">
                        <span>Выберите X:</span>
                        <h:selectOneRadio id="inputX" value="#{pointsBean.x}" validatorMessage="X должен быть в диапазоне [-3; 5]">
                            <f:selectItem itemValue="-3" itemLabel="-3"/>
                            <f:selectItem itemValue="-2" itemLabel="-2"/>
                            <f:selectItem itemValue="-1" itemLabel="-1"/>
                            <f:selectItem itemValue="0" itemLabel="0"/>
                            <f:selectItem itemValue="1" itemLabel="1"/>
                            <f:selectItem itemValue="2" itemLabel="2"/>
                            <f:selectItem itemValue="3" itemLabel="3"/>
                            <f:selectItem itemValue="4" itemLabel="4"/>
                            <f:selectItem itemValue="5" itemLabel="5"/>
                            <f:validateDoubleRange minimum="-3" maximum="5"/>
                        </h:selectOneRadio>
                        <br/>
                        <h:message for="inputX" id="xError" style="animation-duration: 2s"/>
                        <br/>

                        <span>Введите Y[-3, 3]:</span>
                        <h:inputText id="inputY" value="#{pointsBean.y}" validatorMessage="Y должен быть в диапазоне [-3; 3]">
                            <f:validateDoubleRange minimum="-3" maximum="3"/>
                        </h:inputText>

                        <br/>

                        <h:message for="inputY" id="yError" style="animation-duration: 2s"/>

                        <br/>

                        <span>Выберите R:</span>
                        <h:selectOneRadio id="inputR" value="#{pointsBean.r}"
                                     validatorMessage="R должен быть в диапазоне [1; 3]">
                            <f:selectItem itemValue="1" itemLabel="1"/>
                            <f:selectItem itemValue="1.5" itemLabel="1.5"/>
                            <f:selectItem itemValue="2" itemLabel="2"/>
                            <f:selectItem itemValue="2.5" itemLabel="2.5"/>
                            <f:selectItem itemValue="3" itemLabel="3"/>
                            <f:validateDoubleRange minimum="1" maximum="3"/>

                        </h:selectOneRadio>
                        <br/>
                        <h:message for="inputR" id="rError" style="animation-duration: 2s"/>
                        <br/>

                        <h:commandButton value="Отправить" action="#{pointsBean.addPoint}"
                                         id="submitButton">
                        <f:ajax execute="@form" render="svg statsTable" />
                        </h:commandButton>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <div class="statsTableDiv">
                        <h:dataTable id="statsTable" value="#{pointsBean.points}" var="point"
                                     border="1" class="statsTable">
                            <h:column>
                                <f:facet name="header">X</f:facet>
                                #{point.x}
                            </h:column>
                            <h:column styleClass="Y">
                                <f:facet name="header">Y</f:facet>
                                #{point.y}
                            </h:column>
                            <h:column>
                                <f:facet name="header">R</f:facet>
                                #{point.r}
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    Попадание/промах
                                </f:facet>
                                #{point.status}
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    Текущее время
                                </f:facet>
                                #{point.currentTime}
                            </h:column>
                            <h:column>
                                <f:facet name="header">
                                    Время выполнения
                                </f:facet>
                                #{point.executionTime}
                            </h:column>
                        </h:dataTable>
                    </div>
                </td>
            </tr>
        </table>
    </h:form>
</h:body>
</html>